<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html" xmlns:th="http://www.thymeleaf.org"><head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
    <title th:text="#{lblUserTitle}"></title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/userMaster.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/mc-datepicker/dist/mc-calendar.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="../css/magnific-popup.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/pagination.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="../js/ajaxMessage/passwordChangeErrorMessages.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="https://cdn.datatables.net/fixedcolumns/4.0.2/js/dataTables.fixedColumns.min.js"></script>
    <script src="../js/jquery.magnific-popup.js"></script>
    <script src="../js/jquery.magnific-popup.min.js"></script>
    <script src="../js/moment.js"></script>
    <script src="../js/moment-timezone.min.js"></script>
    <script src="../js/moment-timezone-with-data.js"></script>

    <script src="../js/common.js"></script>
    <script th:if="${languageOption} == 0" src="../js/calendarJp.js"></script>
    <script th:if="${languageOption} == 1" src="../js/calendarEn.js"></script>

</head>
<style>
    .header-sticky{
        position:sticky;
        top:0;
        background-color:white;
        z-index: 5;
    }
    .mfp-bg{
        z-index:1002 !important;
    }

    .mfp-wrap{
        z-index:1002 !important;
    }
</style>
<body>

<th:block :: header th:include="@{/menu.html}"></th:block>


<!--ユーザーマスタ-->
<div class="box box-4 container mt-5">
    <div class="box-content">
        <h2 th:text="#{lblUserTitle}"></h2>

        <form class="generalForm" th:action="@{/searchUserMaster}" method="POST" novalidate
              th:object="${user}">
            <div class="row mt-5">
                <div class="col-xl-6 col-lg-6 col-sm-6 col-12">
                    <div class="row">
                        <label class="col-xl-3 col-lg-3 col-sm-4 col-4 label text-info text-center mt-2 " th:text="#{lblEmployeeNo}+':'"></label>
                        <div class="form__group field col-xl-9 col-lg-9 col-sm-8 col-8">
                            <input type="input" class="form__field" th:value="${employeeNumber}"
                                   name="userCode" id='userCode' required />
                        </div>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-sm-6 col-12">
                    <div class="row">
                        <label class="col-xl-3 col-lg-3 col-sm-4 col-4 label text-info text-center mt-2 " th:text="#{lblEmpName}+':'"></label>
                        <div class="form__group field col-xl-9 col-lg-9 col-sm-8 col-8">
                            <input type="input" class="form__field" th:value="${employeeName}"
                                   name="userName" id='name' required />
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-5 justify-content-end ">
                <button type="submit" class="btn btn-secondary btn-xs col-2 mt-3" style="width:102px;margin-right:30px;"
                        th:text="#{btnSearch}"></button>
                <button id="newRegistrationBtn" onclick="saveScreen('/usercontrol')" type="button" class="btn btn-secondary btn-xs  col-2 mt-3" style="width:102px;"
                   th:text="#{btnNewReg}"></button>
            </div>
        </form>
    </div>
</div>

<!--info popup-->
<div id="info-popup" class="box box-4 container mt-5 info-popup-width mfp-hide info-popup-position  ">
    <div class="box-content">
        <h2 th:text="#{lblUserUpdate}"></h2>
        <form th:action="@{/updateUserInformation}" method="POST" id="userControlForm">

            <div class="row mt-3 margin-xs">
                <div class="col-xl-6 col-lg-6 col-sm-6 col-12">
                    <div class="row">
                        <label class="p-0 font24 col-3 label text-info text-center mt-2 " th:text="#{lblEmployeeNo}+':'"></label>
                        <div class="form__group field col-9">
                            <input oninput="inputChange('empNumberErr')" type="input" class="form__field" id='emp_num' name="employeeNumber" maxlength="5"
                                   readonly/>
                        </div>
                    </div>
                </div>

                <div class="col-xl-6 col-lg-6 col-sm-6 col-12 mt-xl-0 mt-lg-0 mt-md-2 mt-m-2 mt-2">
                    <div class="row">
                        <label class="p-0 font24 col-3 label text-info text-center mt-2" th:text="#{lblComName}+':'"></label>
                        <div class="col-9">
                            <select class="form-select" aria-label="Default select example" name="companyCode" id="companyName">
                                <option th:each="company,stat: ${companyList}"
                                        th:text="${languageOption}== 0? ${company.companyNameJPN}: ${company.companyNameENG}"
                                        th:value="${company.companyCode}"></option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-xl-3 mt-lg-3 mt-md-0 mt-sm-0 mt-0 margin-xs">
                <div class="col-xl-6 col-lg-6 col-sm-6 col-12 mt-xl-0 mt-lg-0 mt-md-2 mt-m-2 mt-2">
                    <div class="row">
                        <label class=" p-0 font24 col-3 label text-info text-center  mt-2 " th:text="#{lblEmpName}+':'"></label>
                        <div class="form__group field col-9">
                            <input oninput="inputChange('empNameErr')"  type="input" class="form__field"
                                   name="employeeName" id='emp_name' required maxlength="50"/>
                        </div>
                        <div class=" col-12" id="empNameErr" style="visibility:hidden;">
                            <div class="row">
                                <label class="col-3 label text-info text-center  mt-2 "></label>
                                <div class="form__group field col-9">
                                    <span id="empNameErrMsg" style="color:red;"> </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-sm-6 col-12 mt-xl-0 mt-lg-0 mt-md-2 mt-m-2 mt-2">
                    <div class="row">
                        <label class=" p-0 font24 col-3 label text-info text-center  mt-2 " th:text="#{lblStartDate}+':'"></label>
                        <div class="form__group field col-9">
                            <input readonly type="input" class="form__field" name="startDate" id='startDate' autocomplete="off"
                                   required onfocus="openCalander('#startDate','startDateErr')"/>
                        </div>
                        <div class="col-12" id="startDateErr" style="visibility:hidden">
                            <div class="row">
                                <label class="col-3 label text-info text-center  mt-2 "></label>
                                <div class="form__group field col-9">
                                    <span id="startDateErrMsg" style="color:red;"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-xl-3 mt-lg-3 mt-md-0 mt-sm-0 mt-0 margin-xs">
                <div class="col-xl-6 col-lg-6 col-sm-6 col-12 mt-xl-0 mt-lg-0 mt-md-2 mt-m-2 mt-2">
                    <div class="row">
                        <label class=" p-0 font24 col-3 label text-info text-center mt-2 " th:text="#{lblAuthoritySelect}+':'"></label>
                        <div class="col-9">
                            <select onchange="roleChange()" id="role" class="form-select" name="role"  aria-label="Default select example">
<!--                                <option selected value="1">System Admin</option>-->
<!--                                <option value="2">General User</option>-->
                                <option selected value="0" th:text="${languageOption}== 0? '管理者': 'Admin'" ></option>
                                <option value="1" th:text="${languageOption}== 0? '一般ユーザー': 'User'" ></option>
                                <option th:if="${role} == '2'" value="2" th:text="${languageOption}== 0? 'HL': 'HL'" ></option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-sm-6 col-12 mt-xl-0 mt-lg-0 mt-md-2 mt-m-2 mt-2">
                    <div class="row">
                        <label class=" p-0 font24 col-3 label text-info text-center mt-2 " th:text="#{lblEndDate}+':'"></label>
                        <div class="form__group field col-9">
                            <input  type="input" class="form__field" name="endDate" autocomplete="off"
                                    id='endDate'  readonly onfocus="openCalander('#endDateErr')" />
                        </div>
                        <div class="col-12" id="endDateErr" style="visibility:hidden">
                            <div class="row">
                                <label class="col-3 label text-info text-center  mt-2 "></label>
                                <div class="form__group field col-9">
                                    <span id="endDateErrMsg" style="color:red;"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-xl-3 mt-lg-3 mt-md-0 mt-sm-0 mt-0 margin-xs">
                <div class="col-xl-6 col-lg-6 col-sm-6 col-12 mt-xl-0 mt-lg-0 mt-md-2 mt-m-2 mt-2">
                    <div class="row">
                        <label class=" p-0 font24 col-3 label text-info text-center mt-2 " th:text="#{lblMail}+':'"></label>
                        <div class="form__group field col-9">
                            <input  type="input" class="form__field" name="emailAddress" autocomplete="off"
                                    id='mail' maxlength="30"/>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-3 justify-content ">
                <div class="btn btn-secondary font24  col-2 mt-3" style="width:102px;"
                        th:text="#{btnUpdate}" onclick="updateUser()"></div>
            </div>
        </form>
    </div>
</div>

<!--scheduleControll popup-->
<div id="scheduleControl-popup" class="box box-4 container mt-5 info-popup-width mfp-hide info-popup-position " style="position:fixed;top:43%;left:50%;transform: translate(-50%, -50%);z-index:100;">
    <div class="box-content">
        <h2 th:text="#{lblExportItemUpdate}" ></h2>
        <!--        <h3 class="mt-4" th:text="#{lblExportRegistration}"></h3>-->
        <form th:action="@{/updateUserScheduleControl}" method="POST" modelAttribute="schedleControl">
            <div style="height:400px;overflow-y:scroll;">
                <div class="box box-4 container mt-1 " style="width: 100%; ">
                    <div class="box-content p-0" id="scheduleCheckBox">
                        <input type="text" id="scheduleUpdateUserId" name="userCode" hidden>
                        <div class="row mt-1 justify-content-between">
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="customerName" name="customerName"
                                               type="checkbox">
                                        <label class="form-check-label" for="customerName" th:text="#{lblCustomerName}">
                                            顧客名
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="patternName" name="patternName" type="checkbox">
                                        <label class="form-check-label" for="patternName" th:text="#{lblPatternName}">
                                            パターン名称:
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="billingMonth" name="billingMonth" type="checkbox">
                                        <label class="form-check-label" for="billingMonth" th:text="#{lblBillingMonth}">
                                            請求月
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="bookingNo" name="bookingNo" type="checkbox">
                                        <label class="form-check-label" for="bookingNo">
                                            bookingNo
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="poNO" name="poNo" type="checkbox">
                                        <label class="form-check-label" for="poNo">
                                            po
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="shippingAgency" name="shippingAgency" type="checkbox">
                                        <label class="form-check-label" for="shippingAgency" th:text="#{lblShippingAgency}">
                                            船社代理店
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="exportInport" name="exportInport" type="checkbox">
                                        <label class="form-check-label" for="exportInport" th:text="#{lblExportOrImport}">
                                            輸出or輸入
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="incoterms" name="incoterms" type="checkbox">
                                        <label class="form-check-label" for="incoterms" >
                                            Incoterms
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="shipName" name="shipName"
                                               type="checkbox">
                                        <label class="form-check-label" for="shipName" th:text="#{lblShipName}">
                                            船名
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="voyNo" name="voyNo" type="checkbox">
                                        <label class="form-check-label" for="voyNo" >
                                            VOY No
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row justify-content-between">
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="invoiceCode" name="invoiceCode"
                                               type="checkbox">
                                        <label class="form-check-label" for="invoiceCode" th:text="#{lblInvoiceNo}">
                                            インボイスNo
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="packing" name="packing" type="checkbox">
                                        <label class="form-check-label" for="packing" th:text="#{lblPacking}">
                                            梱包
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="transportMode" name="transportMode" type="checkbox">
                                        <label class="form-check-label" for="transportMode" th:text="#{lblTransportMode}">
                                            輸送モード
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="fourtyf" name="fourtyf" type="checkbox">
                                        <label class="form-check-label" for="fourtyf">
                                            40f
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="twentyf" name="twentyf" type="checkbox">
                                        <label class="form-check-label" for="twentyf">
                                            20f
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="invoicePrice" name="invoicePrice" type="checkbox">
                                        <label class="form-check-label" for="invoicePrice" th:text="#{lblInvoicePrice}">
                                            インボイス価格
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="blawbNo" name="blawbNo" type="checkbox">
                                        <label class="form-check-label" for="blawbNo">
                                            BL No AWB No
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="departurePort" name="departurePort" type="checkbox">
                                        <label class="form-check-label" for="departurePort" th:text="#{lblDeparturePort}">
                                            出発港
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="arrivalPort" name="arrivalPort"
                                               type="checkbox">
                                        <label class="form-check-label" for="arrivalPort" th:text="#{lblArrivalPort}">
                                            到着港
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="cut" name="cut" type="checkbox">
                                        <label class="form-check-label" for="cut" >
                                            cut
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row  justify-content-between">
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="etd" name="etd"
                                               type="checkbox">
                                        <label class="form-check-label" for="etd">
                                            ETD
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="eta" name="eta" type="checkbox">
                                        <label class="form-check-label" for="eta" >
                                            ETA
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="anAdvanceFee" name="anAdvanceFee" type="checkbox">
                                        <label class="form-check-label" for="anAdvanceFee" th:text="#{lblAnAdvanceFee}">
                                            AN立替費用
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="supplierName" name="supplierName" type="checkbox">
                                        <label class="form-check-label" for="supplierName" th:text="#{lblSupplierName}">
                                            仕入先名
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="representativeItem" name="representativeItem" type="checkbox">
                                        <label class="form-check-label" for="representativeItem" th:text="#{lblRepItem}">
                                            代表アイテム
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="freightKg" name="freightKg" type="checkbox">
                                        <label class="form-check-label" for="freightKg" th:text="#{lblCargoKg}">
                                            貨物Kg
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="freightM3" name="freightM3" type="checkbox">
                                        <label class="form-check-label" for="freightM3" th:text="#{lblCargoM3}">
                                            貨物m3
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="ctsNumber" name="ctsNumber" type="checkbox">
                                        <label class="form-check-label" for="ctsNumber" th:text="#{lblCTSNo}">
                                            CTS数
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="size" name="size"
                                               type="checkbox">
                                        <label class="form-check-label" for="size" th:text="#{lblSize}">
                                            サイズ
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="rtShip" name="rtShip" type="checkbox">
                                        <label class="form-check-label" for="rtShip" >
                                            RT(ship)
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row  justify-content-between">
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="vwAir" name="vwAir"
                                               type="checkbox">
                                        <label class="form-check-label" for="vwAir">
                                            VW(air)
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="hlBoxesNumber" name="hlBoxesNumber" type="checkbox">
                                        <label class="form-check-label" for="hlBoxesNumber" th:text="#{lblPackingBox}">
                                            HL梱包箱数
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="moneyOrder" name="moneyOrder" type="checkbox">
                                        <label class="form-check-label" for="moneyOrder" th:text="#{lblMoneyOrder}">
                                            為替
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="inportTaxAdvanceAmount" name="inportTaxAdvanceAmount" type="checkbox">
                                        <label class="form-check-label" for="inportTaxAdvanceAmount" th:text="#{lblImportAmt}">
                                            輸入税立替金額
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="remarks" name="remarks" type="checkbox">
                                        <label class="form-check-label" for="remarks" th:text="#{lblRemark}">
                                            備考
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="declarationDate" name="declarationDate" type="checkbox">
                                        <label class="form-check-label" for="declarationDate" th:text="#{lblDeclarationDt}">
                                            申告日
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="inspectionDate" name="inspectionDate" type="checkbox">
                                        <label class="form-check-label" for="inspectionDate" th:text="#{lblDeclarationDt}">
                                            検査日
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="deliveryDateAndTime" name="deliveryDateAndTime" type="checkbox">
                                        <label class="form-check-label" for="deliveryDateAndTime" th:text="#{lblDeliveryDate}">
                                            配送日時刻
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="possiblePickUpDate" name="possiblePickUpDate"
                                               type="checkbox">
                                        <label class="form-check-label" for="possiblePickUpDate" th:text="#{lblPossiblePickupDate}">
                                            引き取り可能日
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="pickUpDate" name="pickUpDate" type="checkbox">
                                        <label class="form-check-label" for="pickUpDate" th:text="#{lblPickupDate}">
                                            集荷日
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row justify-content-between">
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="containerNo" name="containerNo" type="checkbox">
                                        <label class="form-check-label" for="containerNo" th:text="#{lblContainerNo}">
                                            コンテナNo
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="cargoInsurance" name="cargoInsurance" type="checkbox">
                                        <label class="form-check-label" for="cargoInsurance" th:text="#{lblCargoInsurance}">
                                            貨物保険
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="logisticsCost" name="logisticsCost" type="checkbox">
                                        <label class="form-check-label" for="logisticsCost" th:text="#{lblLogisticsCost}">
                                            物流費
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mt-3">
                                <div class="row">
                                    <div class="form-check">
                                        <input class="form-check-input" id="freeTime" name="freeTime" type="checkbox">
                                        <label class="form-check-label" for="freeTime" th:text="#{lblFreeTime}">
                                            自由時間
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row  justify-content">
                <button type="submit" class="btn btn-secondary font24  col-2 mt-3" style="width:102px;"
                        th:text="#{btnUpdate}"></button>
            </div>
        </form>
    </div>
</div>

<!--userControl popup-->
<div id="userControl-popup" class="box box-4 container mt-5 info-popup-width mfp-hide info-popup-position " style="position:fixed;top:43%;left:50%;transform: translate(-50%, -50%);z-index:100;">
    <div class="box-content">
        <h2 th:text="#{lblUserUpdate}"></h2>
        <form th:action="@{/updateUserControl}" method="POST">
            <div class="box box-4 p-0 container mt-5 mb-1">
                <div class="box-content">
                    <input type="text" id="userControlUpdateUserId" name="userCode" hidden>
                    <table class="table table-striped table-bordered text-center">
                        <thead>
                        <tr>
                            <th scope="col"></th>
                            <th scope="col"><label class="font24  form-check-label" for="Editable" th:text="#{lblEdit}"></label></th>
                            <th scope="col"><label class="font24  form-check-label" for="Viewable" th:text="#{lblView}"></label></th>
                            <th scope="col"><label class="font24  form-check-label" for="Invisible" th:text="#{lblNotView}"></label></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <th class="font24" scope="row" th:text="#{lblExportRegistration}"></th>
                            <td><input class="form-check-input edit" type="radio" name="exportRegistrationFlg" value="editable" id="Editable" checked="checked" ></td>
                            <td><input class="form-check-input view" type="radio" name="exportRegistrationFlg" value="viewable" id="Viewable"></td>
                            <td><input class="form-check-input" type="radio" name="exportRegistrationFlg" value="invisible" id="Invisible"></td>
                        </tr>
                        <tr>
                            <th class="font24"  scope="row" th:text="#{lblSchedule}"></th>
                            <td><input class="form-check-input edit" type="radio" name="scheduleFlag" value="editable" id="Editable" checked="checked"></td>
                            <td><input class="form-check-input view" type="radio" name="scheduleFlag" value="viewable" id="Viewable"></td>
                            <td><input class="form-check-input" type="radio" name="scheduleFlag" value="invisible" id="Invisible"></td>

                        </tr>
                        <tr>
                            <th class="font24" scope="row" th:text="#{lblUser}"></th>
                            <td><input class="form-check-input edit" type="radio" name="userFlag"  value="editable" id="Editable" checked="checked"></td>
                            <td><input class="form-check-input view" type="radio" name="userFlag" value="viewable" id="Viewable"></td>
                            <td><input class="form-check-input" type="radio" name="userFlag" value="invisible" id="Invisible"></td>
                        </tr>
                        <tr>
                            <th class="font24" scope="row" th:text="#{lblProduct}"></th>
                            <td><input class="form-check-input edit" type="radio" name="productFlag"  value="editable" id="Editable" checked="checked"></td>
                            <td><input class="form-check-input view" type="radio" name="productFlag" value="viewable" id="Viewable"></td>
                            <td><input class="form-check-input" type="radio" name="productFlag" value="invisible" id="Invisible"></td>

                        </tr>
                        <tr id="systemadmin">
                            <th class="font24" scope="row" th:text="#{lblCompany}">会社マスタ</th>
                            <td><input class="form-check-input edit" type="radio" name="companyFlag"  value="editable" id="Editable" checked="checked"></td>
                            <td><input class="form-check-input view" type="radio" name="companyFlag" value="viewable" id="Viewable"></td>
                            <td><input class="form-check-input" type="radio" name="companyFlag" value="invisible" id="Invisible"></td>
                        </tr>
                        <tr>
                            <th class="font24" scope="row" th:text="#{lblGroup}">グループマスタ</th>
                            <td><input class="form-check-input edit" type="radio" name="groupFlag"  value="editable" id="Editable" checked="checked"></td>
                            <td><input class="form-check-input view" type="radio" name="groupFlag" value="viewable" id="Viewable"></td>
                            <td><input class="form-check-input" type="radio" name="groupFlag" value="invisible" id="Invisible"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="row  justify-content">
                <button type="submit" class="btn btn-secondary font24  col-2 mt-3" style="width:102px;"
                        th:text="#{btnUpdate}"></button>
            </div>
        </form>
    </div>
</div>

<!--table-->
<div class="box box-4 container mt-5 ms-0 me-0 mb-5 wrap">
    <div class="box-content ps-0 pe-0">
        <div style="overflow: scroll;">
            <table id="tableId" class="table table-striped table-bordered text-center table-width" >
                <thead>
                <tr class="header-sticky">
                    <th scope="col">No</th>
                    <th scope="col" th:text="#{lblEmployeeNo}"></th>
                    <th scope="col" th:text="#{lblEmpName}">氏名</th>
                    <th th:if="${role == '2'}" scope="col" >HL</th>
                    <th scope="col" th:text="#{lblAdmin}">システム管理者</th>
                    <th scope="col" th:text="#{lblGeneral}">一般</th>
                    <th scope="col" th:text="#{lblUserInfo}">ユーザー情報</th>
                    <th scope="col" th:text="#{lblExportItem}">輸出項目</th>
                    <th scope="col" th:text="#{lblAuthority}">権限</th>
                    <th scope="col">-</th>
                </tr>
                </thead>
                <tbody>
                <tr th:if="${allUsers.role != adminUserrole} " and th:each="allUsers,stat : ${getallUsers}">
                    <th th:text="${stat.count}"></th>
                    <td th:text="${allUsers.userId}" ></td>
                    <td th:text="${allUsers.userName}"></td>
                    <td th:if="${role == '2'}">
                        <input th:if="${allUsers.role} == 2" class="form-check-input" type="checkbox" checked id="inlineCheckbox1" value="option1" disabled>
                        <input th:if="${allUsers.role} == 0" class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1" disabled>
                        <input th:if="${allUsers.role} == 1" class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1" disabled>
                    </td>
                    <td>
                        <input th:if="${allUsers.role} == 0" class="form-check-input" type="checkbox" checked id="inlineCheckbox1" value="option1" disabled>
                        <input th:if="${allUsers.role} == 1" class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1" disabled>
                        <input th:if="${allUsers.role} == 2" class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1" disabled>
                    </td>
                    <td>
                        <input th:if="${allUsers.role} == 1" class="form-check-input" type="checkbox" checked id="inlineCheckbox1" value="option1" disabled>
                        <input th:if="${allUsers.role} == 0" class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1" disabled>
                        <input th:if="${allUsers.role} == 2" class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1" disabled>
                    </td>
                    <td>
                        <button th:attr="class=${(isSystemAdmin == false && allUsers.userId != userCode) ? 'open-popup-link btn btn-outline-primary btn-sm disabled' : 'open-popup-link btn btn-outline-primary btn-sm '}" href="#info-popup"   th:onclick="showInfo([[${allUsers}]]);"
                                type="button" style="border-radius:10px; width:65px;height:35px" th:text="#{btnEdit}"></button>
                    </td>
                    <td>
                        <button th:attr="class=${(isSystemAdmin == false && allUsers.userId != userCode) ? 'open-popup-link btn btn-outline-primary btn-sm disabled' : 'open-popup-link btn btn-outline-primary btn-sm '}" href="#scheduleControl-popup"   th:onclick="showScheduleControl([[${allUsers.userId}]]);" type="button"  style="border-radius:10px; width:65px;height:35px" th:text="#{btnEdit}"></button>
                    </td>
                    <td>
                        <button th:attr="class=${(isSystemAdmin == false && allUsers.userId != userCode) ? 'open-popup-link btn btn-outline-primary btn-sm disabled' : 'open-popup-link btn btn-outline-primary btn-sm '}" href="#userControl-popup"  th:onclick="showUserControl([[${allUsers.userId}]],[[${allUsers.role}]]);" type="button"  style="border-radius:10px; width:65px;height:35px" th:text="#{btnEdit}"></button>
                    </td>
                    <td>
                        <button disabled th:if="${isSystemAdmin == false}" th:href="'#confirm-popup-'+${stat.count}"  type="button" class="open-popup-link btn btn-outline-danger btn-sm" style="border-radius:10px; width:65px;height:35px" th:text="#{btnDelete}"></button>
                        <button disabled th:if="${allUsers.userId == userCode && isSystemAdmin == true}" th:href="'#confirm-popup-'+${stat.count}"  type="button" class="open-popup-link btn btn-outline-danger btn-sm" style="border-radius:10px; width:65px;height:35px" th:text="#{btnDelete}"></button>
                        <button  th:if="${allUsers.userId != userCode && isSystemAdmin == true}" th:href="'#confirm-popup-'+${stat.count}"  type="button" class="open-popup-link btn btn-outline-danger btn-sm" style="border-radius:10px; width:65px;height:35px" th:text="#{btnDelete}"></button>
                        <div th:id="'confirm-popup-'+${stat.count}" class="box box-4 container mt-5 delete-popup-width mfp-hide " style="position:fixed;top:43%;left:50%;transform: translate(-50%, -50%);z-index:100;">
                            <div class="box-content">
                               <div class="row">
                                   <h5 class="text-center" th:text="#{msgDeleteMessage}"></h5>
                               </div>
                                <div class="row justify-content-center mt-4">
                                    <a  type="button" class="btn btn-outline-danger btn-sm deleteBtn " style="border-radius:10px; width:65px;height:35px"
                                       th:href="@{/deleteUserMaster/{userCode}(userCode=${allUsers.userId})}"
                                       th:text="#{btnYes}">
                                    </a>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    let languageFlag = "[[${languageOption}]]";
    loadErrorMessage();

    function updateUser() {
        let empName = document.getElementById('emp_name');
        let startDate = document.getElementById('startDate');
        let endDate = document.getElementById('endDate');
        let valid = true;

        if (empName.value === "") {
            showErrorMsg("empNameErr", userNameEmptyErrorMsg, userNameEmptyErrorMsg, "empNameErrMsg", languageFlag)
            valid = false;
        }

        if (startDate.value === "") {
            showErrorMsg("startDateErr", startDateEmptyErrorMsg, startDateEmptyErrorMsg, "startDateErrMsg", languageFlag)
            valid = false;
        }

        if (startDate.value != "" && endDate.value != "") {
            if (Date.parse(endDate.value) <= Date.parse(startDate.value)) {
                showErrorMsg("endDateErr", startGreaterEndDateErrorMsg, startGreaterEndDateErrorMsg, "endDateErrMsg", languageFlag)
                valid = false;
            }
        }

        if (valid === true) {
            let form_elem = document.getElementById('userControlForm');
            form_elem.submit();
        } else if (valid === false) {
            window.scrollTo(0, 0);
        }
    }

    function showInfo(user){
        let startDate = formatDate(user.startDate);
        let endDate = formatDate(user.endDate);
        document.getElementById("emp_num").value=user.userId;
        selectComboBox("#companyName",user.companyCode);
        document.getElementById("emp_name").value=user.userName;
        selectComboBox("#role",parseInt(user.role))
        document.getElementById("startDate").value= startDate;
        document.getElementById("endDate").value = endDate;
        document.getElementById("mail").value = user.emailAddress;
        document.getElementById("startDateErr").style.visibility = 'hidden';
        document.getElementById("endDateErr").style.visibility = 'hidden';
        document.getElementById("empNameErr").style.visibility = 'hidden';
    }

    function showScheduleControl(userCode){
        const scheduleBox = document.getElementById('scheduleCheckBox');
        const checkboxes = scheduleBox.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            checkbox.checked = false;
        });
        document.getElementById('scheduleUpdateUserId').value = userCode;
        $.post('/getScheduleControlByUserId', {
            userCode: userCode
        }, function(data){
            if(data != " "){
                for (const [key, value] of Object.entries(data)) {
                    document.getElementById(key).checked = false;
                    if(value == 1){
                        document.getElementById(key).checked = true;
                    }
                }
            }
        });
    }

    function showUserControl(userCode,role){
        let element = document.getElementsByClassName("edit")
        if(role == 1){
            for (var i = 0; i < element.length; i++) {
                element.item(i).disabled = true;
            }
        }else{
            for (var i = 0; i < element.length; i++) {
                element.item(i).disabled = false;
            }
        }
        document.getElementById('userControlUpdateUserId').value = userCode;
        $.post('/getUserControlByUserId',{userCode:userCode},function(data){
            if(data != " "){
                for (const [key, value] of Object.entries(data)) {
                    if(key != "userCode"){
                        const radioButtons = document.querySelectorAll('input[name="'+key+'"]')
                        radioButtons.forEach((radioButton, index) => {


                            if (radioButton.id === 'Editable' && value === 1) {
                                radioButton.checked = true;
                            }
                            if (radioButton.id === 'Viewable' && value === 2){
                                radioButton.checked = true;
                            }
                            if (radioButton.id === 'Invisible' && value === 3){
                                radioButton.checked = true;
                            }
                        });
                    }
                }
            }
        })
    }

    $('.open-popup-link').magnificPopup({
        type:'inline',
        midClick: true // Allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source in href.
    });

    $(document).ready(function() {
        let table = $('#tableId').DataTable( {
            <!--    dom: 'lpftrip',-->
            searching: false,
            ordering: false,
            "lengthChange": false,
            dom: '<"clear">lfrtp',
            pagingType:     "simple_numbers",
            pageLength:     10,
            scrollX: true,
            language: {
                'paginate': {
                    'previous': '<span class="prev-icon"><i class="fa fa-backward" aria-hidden="true"></i></span>',
                    'next': '<span class="next-icon"><i class="fa fa-forward" aria-hidden="true"></i></span>'
                }
            }

        });
    });

    window.onload = function() {
        document.getElementById("navbarDropdownMenuLink").classList.add("active");
        let userControlFlag = "[[${userControlFlag.userFlag}]]";
        if(userControlFlag == '2'){
            $("input").prop("disabled", true);
            $("select").prop("disabled", true);
            $("button").prop("disabled", true);
            $("#newRegistrationBtn").css('pointer-events','none');
            $(".deleteBtn").css('pointer-events','none');
        }
    };

    function selectComboBox(id,value){
        Array.from(document.querySelector(id).options).forEach(function(option_element) {
            if(option_element.value == value){
                option_element.selected = true;
            }
        });
    }

    function openCalander(dateTemp,errorMsgElementId){
        var date = dateTemp;
        const myDatePicker = MCDatepicker.create({
            el: date,
            closeOnBlur: true,
            dateFormat: 'YYYY/MM/DD',
            bodyType: 'inline',
            theme: {
                display: {
                    foreground: 'rgba(255, 255, 255, 0.8)',
                    background: '#18477E'
                },
                main_background: '#fff',
                weekday:{
                    foreground:'#18477E'
                },
                date:{
                    active:{
                        picked:{
                            background:'#18477E'
                        }
                    }
                },
                button:{
                    success:{
                        foreground:'#18477E'
                    }
                },
            },
        });
        myDatePicker.open();
        myDatePicker.onOpen(()=>{
            var elem = document.getElementById(errorMsgElementId)
            if(elem != null){
                elem.style.visibility = "hidden";
            }
        })

    };

    function formatDate(date){
        if(date != null){
            const rawDate = moment(date).tz('Asia/Tokyo');
            return rawDate.format('YYYY/MM/DD')
        }else {
            return null
        }
    }

</script>
<script>

</script>

</body>
</html>